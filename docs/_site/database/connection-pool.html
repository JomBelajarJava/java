<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Connection Pool | Tutorial Java</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Connection Pool" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Tutorial Java untuk membuat connection pool menggunakan library HikariCP untuk menjadikan aplikasi lebih efisyen" />
<meta property="og:description" content="Tutorial Java untuk membuat connection pool menggunakan library HikariCP untuk menjadikan aplikasi lebih efisyen" />
<link rel="canonical" href="http://localhost:4000/java/database/connection-pool" />
<meta property="og:url" content="http://localhost:4000/java/database/connection-pool" />
<meta property="og:site_name" content="Tutorial Java" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-09-27T00:00:00+08:00" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/java/database/connection-pool"},"@type":"BlogPosting","url":"http://localhost:4000/java/database/connection-pool","headline":"Connection Pool","dateModified":"2017-09-27T00:00:00+08:00","datePublished":"2017-09-27T00:00:00+08:00","description":"Tutorial Java untuk membuat connection pool menggunakan library HikariCP untuk menjadikan aplikasi lebih efisyen","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/java/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/java/feed.xml" title="Tutorial Java" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/java/">Tutorial Java</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          <a class="page-link" href="http://localhost:4000">Jom Belajar Java</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <h1 id="connection-pool">Connection Pool</h1>

<p><em>Pool</em> dalam English bermaksud ‘kolam’. Biasanya orang menyimpan ikan yang ditangkap ke dalam kolam untuk diguna/dimakan di kemudian hari. Jadi, <em>connection pool</em> bermaksud ‘kolam connection database’, supaya kita boleh menggunakan connection yang sudah disambung untuk membuat operasi database berkali-kali.</p>

<p>Penyambungan ke database yang kita buat sebelum ini sebenarnya kurang efisyen terutamanya untuk aplikasi yang berjalan lama seperti web kerana kita perlu membuat penyambungan ke database semula tiap kali kita melakukan operasi database.</p>

<h2 id="hikaricp">HikariCP</h2>

<p>Kita boleh menulis sendiri code untuk membuat connection pool, tapi tak perlulah. Kita guna saja library yang telah banyak membuat research untuk menjadikan connection pool lebih efisyen. Saya perkenalkan, <a href="https://github.com/brettwooldridge/HikariCP">HikariCP</a>.</p>

<p>HikariCP digunakan secara <em>default</em> jika anda menggunakan <em>web framework</em> seperti <a href="https://projects.spring.io/spring-boot">Spring Boot</a>, <a href="https://www.playframework.com">Play Framework</a> atau <a href="http://www.luminusweb.net">Luminus</a>.</p>

<h2 id="setup">Setup</h2>

<p>HikariCP ialah library Java, jadi kita tambah sahaja di file <code class="highlighter-rouge">pom.xml</code>:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.zaxxer<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>HikariCP<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>2.6.2<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<p>Untuk membuat sambungan ke database menggunakan HikariCP, tambah code berikut di constructor H2Application:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">HikariConfig</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HikariConfig</span><span class="o">();</span>
<span class="n">config</span><span class="o">.</span><span class="na">setJdbcUrl</span><span class="o">(</span><span class="n">DATABASE_URL</span><span class="o">);</span>
<span class="n">config</span><span class="o">.</span><span class="na">setUsername</span><span class="o">(</span><span class="n">NAME</span><span class="o">);</span>
<span class="n">config</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">PASSWORD</span><span class="o">);</span>
</code></pre></div></div>

<p>Tambah field untuk <code class="highlighter-rouge">DataSource</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">final</span> <span class="n">DataSource</span> <span class="n">dataSource</span><span class="o">;</span>
</code></pre></div></div>

<p>dan initialize field tersebut menggunakan config yang telah dibuat:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dataSource</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HikariDataSource</span><span class="o">(</span><span class="n">config</span><span class="o">);</span>
</code></pre></div></div>

<h2 id="getconnection">getConnection()</h2>

<p>Untuk membuat operasi database, kita boleh menggunakan method <code class="highlighter-rouge">getConnection()</code> daripada <code class="highlighter-rouge">DataSource</code>.</p>

<p>Sebagai contoh, sebelum ini di dalam method <code class="highlighter-rouge">init()</code>, kita menggunakan <code class="highlighter-rouge">DriverManager</code> untuk mendapatkan <code class="highlighter-rouge">Connection</code>. Jadi, ganti sahaja code</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">DriverManager</span><span class="o">.</span><span class="na">getConnection</span><span class="o">(</span><span class="n">DATABASE_URL</span><span class="o">,</span> <span class="n">NAME</span><span class="o">,</span> <span class="n">PASSWORD</span><span class="o">)</span>
</code></pre></div></div>

<p>ke</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dataSource</span><span class="o">.</span><span class="na">getConnection</span><span class="o">()</span>
</code></pre></div></div>

<h2 id="update-dao">Update DAO</h2>

<p>Untuk menggunakan <code class="highlighter-rouge">DataSource</code> yang sama, hantar sahaja field tersebut melalui constructor untuk DAO.</p>

<p>Tukar constructor SimpleKucingDao daripada</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nf">SimpleKucingDao</span><span class="o">(</span><span class="kd">final</span> <span class="n">String</span> <span class="n">url</span><span class="o">,</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">password</span> <span class="o">=</span> <span class="n">password</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ke</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nf">SimpleKucingDao</span><span class="o">(</span><span class="kd">final</span> <span class="n">DataSource</span> <span class="n">dataSource</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">this</span><span class="o">.</span><span class="na">dataSource</span> <span class="o">=</span> <span class="n">dataSource</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Kemudian hantar <code class="highlighter-rouge">dataSource</code> sebagai argument di constructor H2Application:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pendaftaranService</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PendaftaranService</span><span class="o">(</span><span class="k">new</span> <span class="n">SimpleKucingDao</span><span class="o">(</span><span class="n">dataSource</span><span class="o">));</span>
</code></pre></div></div>

<p>Setelah selesai, bolehlah ganti semua code yang menggunakan <code class="highlighter-rouge">DriverManager</code> ke <code class="highlighter-rouge">DataSource</code>.</p>

<p>Code yang lengkap boleh dilihat di <a href="https://github.com/JomBelajarJava/contoh-code-java/tree/master/database/tutorialh2-hikaricp">sini</a>.</p>


<nav style="padding: 20px 0; border-top: 1px solid #e8e8e8">
  <div style="float:left"><a href="/java/database/crud">&lsaquo; Sebelumnya</a></div>
  <div style="float:right"><a href="/java/database/migration">Seterusnya &rsaquo;</a></div>
  <div style="margin:0 auto; width: 105px;">
    <a href="/java/">&bull; Kandungan &bull;</a>
  </div>
</nav>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/java/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Tutorial Java</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Tutorial Java</li><li><a class="u-email" href="mailto:burhanclj@gmail.com">burhanclj@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/JomBelajarJava"><svg class="svg-icon"><use xlink:href="/java/assets/minima-social-icons.svg#github"></use></svg> <span class="username">JomBelajarJava</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
